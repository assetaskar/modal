"use strict";function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function _iterableToArrayLimit(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var a=[],n=!0,r=!1,o=void 0;try{for(var i,s=t[Symbol.iterator]();!(n=(i=s.next()).done)&&(a.push(i.value),!e||a.length!==e);n=!0);}catch(t){r=!0,o=t}finally{try{n||null==s.return||s.return()}finally{if(r)throw o}}return a}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,a){return e&&_defineProperties(t.prototype,e),a&&_defineProperties(t,a),t}var Modal=function(){function t(e,a){_classCallCheck(this,t),this.props=a,e&&document.querySelector(e).addEventListener("click",this.open.bind(this))}return _createClass(t,[{key:"_create",value:function(){var t=this,e=document.createElement("div");e.className="modal",!0===this.props.isBackdropClose&&(e.dataset.close="true");var a=document.createElement("div");a.className="modal__container",this.props.width&&(a.style.width=this.props.width+"px"),a.insertAdjacentHTML("afterbegin",'<div class="modal__header">\n\t\t\t\t<span class="modal__title">'.concat(this.props.title,'</span>\n\t\t\t\t<button class="modal__close" data-close="true">&times;</button>\n\t\t\t</div>'));var n=document.createElement("div");if(n.className="modal__body",e.append(a),a.append(n),this._createContent(this.props.content,n),this.props.footer){var r=document.createElement("div");r.className="modal__footer",this._createContent(this.props.footer,r),a.append(r)}e.onclick=function(e){e.target.dataset.close&&t.close()},this._modal=e}},{key:"open",value:function(){this._create();var t=document.querySelector("body");t.append(this._modal),t.classList.add("hidden")}},{key:"close",value:function(){var t=this;this._modal.classList.add("hide"),document.querySelector("body").classList.remove("hidden"),this._modal.addEventListener("animationend",(function(){t._modal.remove()}),{once:!0})}},{key:"_createContent",value:function(t,e){for(var a=0;a<(null==t?void 0:t.length);a++){for(var n=document.createElement(t[a].tag),r=0,o=Object.entries(t[a]);r<o.length;r++){var i=_slicedToArray(o[r],2),s=i[0],c=i[1];"tag"!==s&&("text"===s?n.innerHTML=c:"on"===s?n.addEventListener(c.event,c.func):n.setAttribute(s,c))}e.append(n)}}}]),t}();function fromURLtoHTML(t,e){return fetch(t).then((function(t){return t.json()})).then((function(t){var a=t.map((function(t){return'\n            <div class="card" data-id="'.concat(t.id,'">\n\t\t\t\t<div class="card__image"><img src="./img/small/').concat(t.id,'.jpg" alt="').concat(t.name,'"></div>\n\t\t\t\t<h2 class="card__name">').concat(t.name,"</h2>\n            </div>\n            ")}));return e.innerHTML=a.join(""),t}))}var productsList,url="https://books-f0680-default-rtdb.firebaseio.com/books.json",cards=document.getElementById("cards");fromURLtoHTML(url,cards).then((function(t){productsList=t})),cards.addEventListener("click",(function(t){var e=t.target.closest(".card");if(e){var a=_slicedToArray(productsList.filter((function(t){return t.id==e.dataset.id})),1)[0],n=new Intl.NumberFormat("kk",{currency:"KZT"});new Modal(null,{title:a.name,width:700,content:[{tag:"img",src:"./img/big/".concat(a.id,".jpg")},{tag:"span",text:"Цена: ".concat(n.format(a.price)," &#8376;")}],footer:[{tag:"button",class:"modal__btn",text:"Добавить в корзину"}]}).open()}}));var registration=new Modal("#registration",{isBackdropClose:!0,title:"Регистрация",content:[{tag:"input",type:"text",id:"name",name:"name",placeholder:"Имя"},{tag:"input",type:"email",id:"email",name:"email",pattern:"^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+.[a-zA-Z0-9-.]+$",placeholder:"Email"},{tag:"input",type:"password",id:"password",name:"password",placeholder:"Password"},{tag:"label",for:"modal-date",text:"День рождения:"},{tag:"input",type:"date",name:"date"}],footer:[{tag:"button",class:"modal__btn",text:"Регистрация",on:{event:"click",func:function(){registration.close()}}},{tag:"button",class:"modal__btn",text:"Уже зарегистрирован(а)",on:{event:"click",func:function(){registration.close(),signIn.open()}}}]}),signIn=new Modal(".sign-in",{isBackdropClose:!0,title:"Вход",content:[{tag:"input",type:"email",name:"email",pattern:"^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+.[a-zA-Z0-9-.]+$",placeholder:"Email"},{tag:"input",type:"password",name:"password",placeholder:"Password"},{tag:"p",text:"Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ratione, voluptatibus."}],footer:[{tag:"button",class:"modal__btn",text:"Sign In"}]});